<template>
  <instructions if.to-view="!lockingPeriodIsEnded">
    <p>Select the number of PRIME tokens you would like to lock and the lock duration, in days, that you wish to lock them, for up to [XX?] days.</p>
    <p>At the end of the locking period [which period?] you will be awarded Reputation proportionally according to the total amount of locked PRIME tokens, the value of the token at the time of locking, and the length of the locking period [?] of all participants.</p>
    <p>After the lock duration you’ve specified has concluded, return to this web page to release the tokens. You will receive back the same amount of tokens that you locked.</p>
  </instructions>
  <div
    class="scheme-dashboard-body lockingTokens"
    ref="dashboard">

    <div if.to-view="refreshing">&nbsp;</div>
    <div else>
      <div
        class="message"
        if.to-view="lockingPeriodHasNotStarted">The locking period has not yet begun. Return between ${lockingStartTime | date:'dayofmonth'} and ${lockingEndTime | date:'dayofmonth'} to lock tokens.</div>

      <div
        class="message"
        if.to-view="inLockingPeriod">
        ${msRemainingInPeriodCountdown | timespan:"seconds"} remaining in the locking period.</div>

      <div
        class="message"
        if.to-view="lockingPeriodIsEnded">The locking period has ended.</div>
    </div>

    <div
      if.to-view="inLockingPeriod"
      with.bind="lockModel">
      <!-- <div
        class="message"
        if.to-view="!tokenIsLiquid">
        <p>There currently isn’t sufficient trading for ETH/${selectedToken.symbol} on the DutchX. Please choose another token or try again later.
          To provide liquidity for ETH/${selectedToken.symbol} on the DutchX, trade on <a
            target="_blank"
            href="https://slow.trade">slow.trade</a>,
          <a
            target="_blank"
            href="https://fairdex.net/">FairDEX</a>,
          or visit the <a
            target="_blank"
            href="https://dutchx.readthedocs.io/en/latest/cli.html">DutchX documentation</a> for more information.</p>

        <p><a
            href="https://dxdao.daostack.io/liquidity"
            target="_blank">See current Token Liquidity here</a>.</p>
      </div> -->
      <div if.to-view="hasPartialAllowance || sufficientAllowance">

        <div class="inputButtonGroup">
          <div class="inputGroup">
            <label for="lockAmount">Tokens to lock:</label>
            <numeric-input id="lockAmount"
              value.two-way="amount | ethwei"
              placeholder="0.0"></numeric-input>
          </div>
          <div class="inputGroup">
            <label for="lockingPeriod">Number of days:</label>
            <numeric-input id="lockingPeriod"
              value.two-way="period | secondsDays"
              placeholder="0.0"></numeric-input>
          </div>
        </div>
      </div>
      <div else>
        <div>Before locking you need to approve the eventual transfer of PRIME tokens to your account</div>
      </div>

      <div if.to-view="hasPartialAllowance">
        <div>
          <formatted-number value.to-view="allowance"></formatted-number> PRIME are already approved for locking
        </div>
      </div>

      <div>
        <button class="button1 tokenSubmitButton"
          if.to-view="hasPartialAllowance || noAllowance"
          onclick.call="approve()">Approve Token Transfer</button>
        <button class="button1"
          else
          onclick.call="lock()"
          disabled.to-view="(!amount || amount.eq(0)) || (!period || period <== 0)">Lock Tokens</button>
      </div>
    </div>

    <div if.to-view="locks.length">
      <locks-for-reputation
        locks.to-view="locks"
        release.call="release({lock, releaseButton })"
        refresh.call="getLocks()"></locks-for-reputation>
    </div>
  </div>
</template>
